{% extends "base.html" %}

{% block content %}
  <h1>Admissions SQL Analysis</h1>

  {% if error %}
    <p><b>Error loading analysis:</b> {{ error }}</p>
  {% else %}
    <h2>Overview</h2>
    <ul>
      <li>Total records: {{ results.total_records }}</li>
      <li>Fall 2026 applicants: {{ results.fall_2026_applicants }}</li>
      <li>International applicants: {{ results.international_percentage }}%</li>
      <li>Fall 2025 acceptance rate: {{ results.fall_2025_acceptance_rate }}%</li>
    </ul>

    <h2>Average Metrics</h2>
    <table class="analysis-table">
      <thead>
        <tr>
          <th>Metric</th>
          <th>Average</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>GPA</td>
          <td>{{ results.average_metrics.gpa }}</td>
        </tr>
        <tr>
          <td>GRE (Quant)</td>
          <td>{{ results.average_metrics.gre }}</td>
        </tr>
        <tr>
          <td>GRE (Verbal)</td>
          <td>{{ results.average_metrics.gre_v }}</td>
        </tr>
        <tr>
          <td>GRE (AW)</td>
          <td>{{ results.average_metrics.gre_aw }}</td>
        </tr>
      </tbody>
    </table>

    <h2>Targeted Queries</h2>
    <ul>
      <li>Fall 2026 American applicant average GPA: {{ results.american_fall_2026_gpa }}</li>
      <li>Average GPA of Fall 2026 acceptances: {{ results.fall_2026_acceptance_gpa }}</li>
      <li>JHU Master's CS applicants: {{ results.jhu_cs_masters }}</li>
      <li>2026 PhD acceptances (Georgetown/MIT/Stanford/CMU): {{ results.ivy_2026_compsci_phds }}</li>
      <li>Same count (LLM fields only): {{ results.ivy_2026_compsci_phds_llm_fields }}</li>
      <li>Same count (raw fields only): {{ results.ivy_2026_compsci_phds_raw_fields }}</li>
    </ul>

    <h2>Term Comparison</h2>
    <ul>
      <li>Fall 2025 applicants: {{ results.fall_2025_applicants }}</li>
      <li>Spring 2025 applicants: {{ results.spring_2025_applicants }}</li>
    </ul>

    <h2>Acceptance Rates (American Applicants)</h2>
    <table class="analysis-table">
      <thead>
        <tr>
          <th>Program</th>
          <th>With GPA</th>
          <th>No GPA</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Master's</td>
          <td>{{ results.masters_acceptance.with_gpa }}%</td>
          <td>{{ results.masters_acceptance.no_gpa }}%</td>
        </tr>
        <tr>
          <td>PhD</td>
          <td>{{ results.phd_acceptance.with_gpa }}%</td>
          <td>{{ results.phd_acceptance.no_gpa }}%</td>
        </tr>
      </tbody>
    </table>
  {% endif %}
{% endblock %}
